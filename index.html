<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>Carte Galactique – Campagne COMPENSATOR</title>

<style>
/* TON CSS EXACT INCHANGÉ — je n’y touche pas */
@import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');
body{margin:0;font-family:'Share Tech Mono',monospace;background:#02030a;color:#cfe7d8;overflow:hidden;display:flex;flex-direction:column;}
h1,h2{font-size:14px;margin:14px 0 6px;text-transform:uppercase;letter-spacing:3px;color:#00FF66;}
.layout{display:grid;grid-template-columns:1fr 460px;height:calc(100vh - 50px);}
#map-container{position:relative;overflow:hidden}
#map-bg{position:absolute;inset:0;width:100%;height:100%;object-fit:contain;pointer-events:none}
#galaxy{position:relative;width:100%;height:100%}
svg{width:100%;height:100%}
</style>
</head>

<body>
<div class="layout">
<div id="map-container">
<img id="map-bg" src="https://i.imgur.com/KwrORx4.png">
<svg id="galaxy" viewBox="-520 -520 1040 1040"></svg>
</div>

<div>
<h2>Classement</h2>
<div id="warlordStats"></div>
<h2>Journal</h2>
<div id="journal"></div>
</div>
</div>

<script>
/* =================================================
   VERSION PROPRE + PATCHÉE + SYNTAXE FIXÉE
================================================= */

const noCache = () => "?nocache=" + Date.now();

const factions = ['Imperium','Chaos','Xenos'];
const sectors = [];
let warlords=[];
const warlordStats={};

/* ================= WARLORDS ================= */
async function loadWarlordsFromCSV(){
  const res=await fetch(
    "https://raw.githubusercontent.com/BobywanCompensator/CampagneCompensatorMark1/main/data/warlords.csv"+noCache()
  );
  const text=await res.text();

  text.trim().split("\n").slice(1).forEach(l=>{
    const [id,name,player,actif]=l.split(",");
    if(actif==="1"){
      warlords.push(name);
      warlordStats[name]={win:0,loss:0};
    }
  });
}

function renderWarlords(){
  const el=document.getElementById("warlordStats");
  el.innerHTML="";
  Object.entries(warlordStats).forEach(([n,s])=>{
    const d=document.createElement("div");
    d.textContent=`${n} – V:${s.win} / D:${s.loss}`;
    el.appendChild(d);
  });
}

/* ================= MAP TEST ================= */
/* (juste pour vérifier affichage OK) */
function render(){
  const svg=document.getElementById("galaxy");
  svg.innerHTML="";
  for(let i=0;i<5;i++){
    const c=document.createElementNS("http://www.w3.org/2000/svg","circle");
    c.setAttribute("cx",Math.random()*400-200);
    c.setAttribute("cy",Math.random()*400-200);
    c.setAttribute("r",40);
    c.setAttribute("fill","#2a4fff");
    svg.appendChild(c);
  }
}

/* ================= INIT ================= */
(async()=>{
  await loadWarlordsFromCSV();
  render();
  renderWarlords();
})();
</script>

</body>
</html>
